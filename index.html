<!DOCTYPE html>
<html>
  <head>
  <title>Horizon NYC Configuration</title>
  <link rel='stylesheet' type='text/css' href='css/slate.min.css'>
  <script src='js/slate.min.js'></script>
  <style>
  .title {
    padding: 15px 10px;
    font-family: 'Roadway', sans-serif;
    font-size: 1.2em;
    font-weight: 500;
    color: #fafafa;
    text-align: center;
  }
  </style>
  </head>

  <body>

    <div class="item-container">
      <div class="item-container-header">Time Settings</div>
      <div class="item-container-content">
       <div class="item tab-buttons">
         <a name="tab-1" id="12-hour-button" class="tab-button">12 HOUR</a>
         <a name="tab-1" id="24-hour-button" class="tab-button">24 HOUR</a>
       </div>
     </div>
    </div>
     <div class='item-container-footer'>
        This switches the time display format.
      </div>
    </div>

    <div class="item-container">
      <div class="item-container-header">Temperature Settings</div>
      <div class="item-container-content">
       <div class="item tab-buttons">
         <a name="tab-2" id="fahrenheit-button" class="tab-button">FAHRENHEIT</a>
         <a name="tab-2" id="celsius-button" class="tab-button">CELSIUS</a>
       </div>
     </div>
    </div>
     <div class='item-container-footer'>
        This switches the temperature format.
      </div>
    </div>

    <div class="item-container">
      <div class="item-container-header">Date Settings</div>
      <div class="item-container-content">
       <div class="item tab-buttons">
         <a name="tab-3" id="mm-dd-button" class="tab-button">MM-DD</a>
         <a name="tab-3" id="dd-mm-button" class="tab-button">DD-MM</a>
       </div>
     </div>
    </div>
     <div class='item-container-footer'>
        This switches the date display format.
      </div>
    </div>

    <div class='item-container'>
       <div class="item-container-header">Donate</div>
      <div class='item-container-content'>
        <div class='button-container'>
        <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
        <input type="hidden" name="cmd" value="_s-xclick">
        <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----
        ">
        <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
        <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
        </form>
        </div>
      </div>
      </div>
    </div>
    <div class='item-container-footer'>
        Your support funds the magic :)
      </div>

    <div class='item-container'>
      <div class='button-container'>
        <input id='submit_button' type='button' class='item-button' value='SUBMIT'>
      </div>
    </div>
  </body>
  <script>

  function getConfigData() {
    var time12HourSelected = document.getElementById('12-hour-button').classList.contains('active');
    var fahrenheitSelected = document.getElementById('fahrenheit-button').classList.contains('active');
    var mmDDSelected = document.getElementById('mm-dd-button').classList.contains('active');
 
    var options = {
      '12_hour_setting': time12HourSelected,
      'fahrenheit_setting': fahrenheitSelected,
      'mm_dd_setting': mmDDSelected
    };

    // Save for next launch
    localStorage['12_hour_setting'] = options['12_hour_setting'];
    localStorage['fahrenheit_setting'] = options['fahrenheit_setting'];
    localStorage['mm_dd_setting'] = options['mm_dd_setting'];

    console.log('Got options: ' + JSON.stringify(options));

    return options;
  }

  function getQueryParam(variable, defaultValue) {
    var query = location.search.substring(1);
    var vars = query.split('&');
    for (var i = 0; i < vars.length; i++) {
      var pair = vars[i].split('=');
      if (pair[0] === variable) {
        return decodeURIComponent(pair[1]);
      }
    }
    return defaultValue || false;
  }
 
  var submitButton = document.getElementById('submit_button');
  submitButton.addEventListener('click', function() {
    console.log('Submit');
    // Close config page and return data
    location.href = 'pebblejs://close#' + 
    encodeURIComponent(JSON.stringify(getConfigData()));
  });

  (function() {
    var timeSettings = document.getElementById('12-hour-button');
    var temperatureSettings = document.getElementById('fahrenheit-button');
    var dateSettings = document.getElementById('mm-dd-button');

    // Load any previously saved configuration, if available
    if(localStorage['12_hour_setting']) {
      console.log('local storage has a thing');
      console.log('time setting:' + JSON.parse(localStorage['12_hour_setting']));

      if(JSON.parse(localStorage['12_hour_setting']) == false) {
        timeSettings.className.replace( /(?:^|\s)active(?!\S)/g , '' );
        document.getElementById('24-hour-button').className += ' active';
      }
      else {
        document.getElementById('24-hour-button').className.replace( /(?:^|\s)active(?!\S)/g , '' );
        timeSettings.className += ' active';
      }
    }
    else {
      timeSettings.className += ' active';
    }

    if(localStorage['fahrenheit_setting']) {
      console.log('local storage has another thing');
      console.log('temp setting:' + JSON.parse(localStorage['fahrenheit_setting']));

      if(JSON.parse(localStorage['fahrenheit_setting']) == false) {
        temperatureSettings.className.replace( /(?:^|\s)active(?!\S)/g , '' );
        document.getElementById('celsius-button').className += ' active';
      }
      else {
        document.getElementById('celsius-button').className.replace( /(?:^|\s)active(?!\S)/g , '' );
        temperatureSettings.className += ' active';
      }
    }
    else {
      temperatureSettings.className += ' active';
    }

    if(localStorage['mm_dd_setting']) {
      console.log('local storage has yet another thing');
      console.log('date setting:' + JSON.parse(localStorage['mm_dd_setting']));

      if(JSON.parse(localStorage['mm_dd_setting']) == false) {
        dateSettings.className.replace( /(?:^|\s)active(?!\S)/g , '' );
        document.getElementById('dd-mm-button').className += ' active';
      }
      else {
        document.getElementById('dd-mm-button').className.replace( /(?:^|\s)active(?!\S)/g , '' );
        dateSettings.className += ' active';
      }
    }
    else {
      dateSettings.className += ' active';
    }
  })();

  </script>
</html>
